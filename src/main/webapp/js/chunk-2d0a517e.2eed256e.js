(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a517e"],{"08dd":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",["images"===e.type?i("div",{staticClass:"images"},e._l(e.documentData,function(e){return i("div",{staticStyle:{padding:"0 50px"}},[i("img",{attrs:{src:e,width:"100%"}})])}),0):e._e(),"markdown"===e.type?i("div",{staticClass:"markdown"},[i("mavon-editor",{ref:"md",attrs:{value:e.documentData,subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,scrollStyle:!0,ishljs:!0}})],1):e._e(),i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isFirstLoading&&e.isLoading,expression:"isFirstLoading && isLoading",modifiers:{fullscreen:!0,lock:!0}}]}),i("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.isFirstLoading&&e.isLoading,expression:"!isFirstLoading && isLoading"}]})])},s=[],a=(i("639b"),i("6657")),o=(i("cc71"),i("7f43")),d=i.n(o),c={name:"DocumentOnlinePreview",components:{mavonEditor:a["mavonEditor"]},data:function(){return{isScrolling:!1,type:"",isSuccess:!0,isLoading:!0,documentId:0,documentType:0,documentUrl:"",pageNum:1,pageSize:4,documentData:[]}},created:function(){this.pageNum=1,this.documentId=this.$route.query.documentId,this.documentType=this.$route.query.documentType,this.documentUrl=this.$route.query.documentUrl,this.loadDocumentData()},mounted:function(){window.addEventListener("scroll",this.handleScroll,!1),window.addEventListener("mousewheel",this.handleScroll,!1),window.addEventListener("DOMMouseScroll",this.handleScroll,!1)},methods:{loadDocumentData:function(){var e=this;this.isLoading=!0;var t=this.documentId,i=this.documentType,n=this.documentUrl,s=this.pageNum,a=this.pageSize;d.a.post("/IGSDN/documentOnlinePreview",{documentId:t,documentType:i,documentUrl:n,pageNum:s,pageSize:a}).then(function(t){e.handleData(t.data),1===e.pageNum&&e.$message({message:"载入成功",type:"success"}),e.pageNum+=1,e.isSuccess=!0,e.isLoading=!1,e.isScrolling=!1}).catch(function(t){e.isLoading=!1,e.isSuccess=!1,e.isScrolling=!1,e.$message.error("抱歉，加载失败了")})},handleScroll:function(e){if(!this.isScrolling&&!this.isLoading){var t=document.documentElement.scrollTop,i=document.documentElement.clientHeight,n=document.documentElement.scrollHeight;0==t&&i==n&&e.deltaY>0&&(this.isScrolling=!0,this.loadDocumentData()),0!=t&&t+i+1>n&&(this.isScrolling=!0,this.loadDocumentData())}},handleData:function(e){var t=this;this.isMarkdown(e)?this.documentData=e[1]:this.isImages(e)&&(e.shift(),e.forEach(function(e){t.documentData.push("data:image/jpg;base64,"+e)}))},isMarkdown:function(e){return e!=[]&&"markdown"==e[0]&&(this.type="markdown",!0)},isImages:function(e){return e!=[]&&"images"==e[0]&&(this.type="images",!0)}},computed:{isFirstLoading:function(){return 1===this.pageNum}}},u=c,r=i("17cc"),l=Object(r["a"])(u,n,s,!1,null,"cc2e7900",null);t["default"]=l.exports}}]);