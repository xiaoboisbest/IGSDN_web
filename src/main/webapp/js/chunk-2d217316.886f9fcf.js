(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217316"],{c64a:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoadingDocumentDetails,expression:"isLoadingDocumentDetails"}],staticClass:"box-card",staticStyle:{width:"800px",margin:"0 auto"}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"文件名称"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"文件权限"}},[i("el-radio-group",{model:{value:e.permission,callback:function(t){e.permission=t},expression:"permission"}},[i("el-radio",{attrs:{label:"公有"}}),i("el-radio",{attrs:{label:"私有"}})],1)],1),i("el-form-item",{attrs:{label:"添加标签"}},[i("el-input",{attrs:{placeholder:"不能超过10个字符"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.intoTags(t)}},model:{value:e.tagsContent,callback:function(t){e.tagsContent=t},expression:"tagsContent"}}),i("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.form.key1,expression:"form.key1"}],staticStyle:{margin:"10px 10px 0 0"},attrs:{closable:""},on:{close:e.deleteKey1}},[e._v("\n                "+e._s(e.form.key1)+"\n            ")]),i("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.form.key2,expression:"form.key2"}],staticStyle:{margin:"10px 10px 0 0"},attrs:{closable:""},on:{close:e.deleteKey2}},[e._v("\n                "+e._s(e.form.key2)+"\n            ")]),i("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.form.key3,expression:"form.key3"}],staticStyle:{margin:"10px 10px 0 0"},attrs:{closable:""},on:{close:e.deleteKey3}},[e._v("\n                "+e._s(e.form.key3)+"\n            ")])],1),i("el-form-item",{attrs:{label:"文件封面"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"1","http-request":e.httpRequest,"show-file-list":!1}},[e.form.iconSrc?i("img",{staticClass:"avatar",attrs:{src:e.form.iconSrc,height:"180px",width:"360px"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"文件描述"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",loading:e.isSubmitting,plain:!0},on:{click:e.onSubmit}},[e._v("\n                "+e._s(e.isSubmitting?"提交中...":"提交")+"\n            ")]),i("el-button",{attrs:{type:"danger"},on:{click:e.goBack}},[e._v("返回")])],1)],1)],1)},a=[],s=(i("c30b"),i("fb6a"),i("611e"),i("7f43")),n=i.n(s),r={name:"EditDocumentDetails",data:function(){return{isLoadingDocumentDetails:!0,isSubmitting:!1,documentId:0,permission:"",form:{name:"",isPublic:!0,key1:"",key2:"",key3:"",intro:"",iconSrc:""},imageUrl:"",tagsContent:"",fileReader:null}},mounted:function(){var e=this;window.FileReader||console.error("Your browser does not support FileReader API!"),this.fileReader=new FileReader,this.documentId=this.$route.query.documentId;var t=null;n.a.post("/IGSDN/getAllCategoryTree",{preList:t}).then(function(t){e.categories=t.data[0]}).catch(function(e){}),this.getDocumentDetails()},watch:{permission:function(e){"公有"==e?this.form.isPublic=!0:"私有"==e&&(this.form.isPublic=!1)}},methods:{getDocumentDetails:function(){var e=this,t=this.documentId;t&&0!=t&&(this.isLoadingDocumentDetails=!0,n.a.get("/IGSDN/getDocumentDetailsBeforeUpdate/"+t).then(function(t){var i=t.data;e.form=i,e.permission=i.isPublic?"公有":"私有",i.iconSrc&&(e.form.iconSrc="data:image/jpg;base64,"+i.iconSrc),e.isLoadingDocumentDetails=!1}).catch(function(t){e.isLoadingDocumentDetails=!1,console.log(t)}))},open1:function(e){this.$message.error(e)},deleteKey1:function(){this.form.key1=""},deleteKey2:function(){this.form.key2=""},deleteKey3:function(){this.form.key3=""},intoTags:function(){this.tagsContent.trim().length>10?this.open1("输入内容太长"):this.key1&&this.key2&&this.key3?this.open1("只能添加三个标签"):this.key1?this.key2?this.key3=this.tagsContent:this.key2=this.tagsContent:this.key1=this.tagsContent,this.tagsContent=""},onSubmit:function(){var e=this;if(this.form.name)if(this.form.intro){var t=this.form;this.isSubmitting=!0,t.uploader=JSON.parse(localStorage.getItem("user_msg")).id,n.a.put("/IGSDN/updateDocument/"+this.documentId,{document:t}).then(function(t){t.data&&(e.isSubmitting=!1,e.$message({message:"上传成功！",type:"success"}),e.goBack())}).catch(function(t){e.isSubmitting=!1,e.$message({message:"上传失败！",type:"error"})})}else this.open1("文件描述不可为空");else this.open1("文件名称不可为空")},beforeAvatarUpload:function(e){var t="image"===e.type.split("/")[0];return t},httpRequest:function(e){var t=this,i=e.file;this.beforeAvatarUpload(i)?(i&&this.fileReader.readAsDataURL(i),this.fileReader.onload=function(){var e=t.fileReader.result;t.form.iconSrc=e}):this.$message.error("封面格式必须为图片！")},goBack:function(){this.$router.go(-1)}}},l=r,c=i("17cc"),m=Object(c["a"])(l,o,a,!1,null,"47505a38",null);t["default"]=m.exports}}]);